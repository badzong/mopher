define STR "test string"
define STRLEN string_strlen(STR)
define INTEGER 1001
define FLOAT 10.01
define MATH FLOAT * 100 / INTEGER

# Math
connect log "MATH"
connect	log ((10 + 10) / 20) + " = 1"
connect	log ((30 * 20 / 100 + 4) / 10) + " = 1"
connect log (1.5 * 10 / 5 + 1.0 * 10.0 - 13.5 + 1.5) + " = 1"
connect log (1 * 0.1 * 0.001 * 1000 / 2 + 0.95) + " = 1"
connect log ((MATH + 5) / 6) + " = 1"
connect log (INTEGER / FLOAT / 100) + " = 1"
connect log ((3 > 4) == 0) + " = 1"
connect log ((1 < 2) == (1 > 0)) + " = 1"
connect log (3.9 >= 4 <= 1) + " = 1"
connect log ""

# Functions
connect log "FUNCTIONS"
connect log string_strlen("test") + " = 4"
connect log (string_strlen("test") / 4 == string_strcmp("test string", STR) + 1)+ " = 1"
connect log (cast(INT, 9.0) * cast(INT, 0.9) + cast(INT, 1.7)) + " = 1"
connect log ""

# Variables
connect log "VARIABLES"
connect set $var1 = 1.0
connect $var2 = $var1 * 5 / 20 + 0.75 log $var2 + " = 1"
connect log ""

# Symbols
connect log "SYMBOLS"
connect log "milter_id = " + milter_id
connect log "milter_mta_version = " + milter_mta_version
connect log "milter_stage = " + milter_stage
connect log "milter_stagename = " + milter_stagename
connect log "milter_received = " + milter_received
connect log "milter_hostaddr = " + milter_hostaddr
connect log "milter_addrstr = " + milter_addrstr
connect log "milter_hostname = " + milter_hostname
helo log "milter_helo = " + milter_helo
envfrom log "milter_envfrom = " + milter_envfrom
envrcpt log "milter_envrcpt = " + milter_envrcpt
data log "milter_recipients = " + milter_recipients
data log "milter_recipient_list = " + milter_recipient_list

#header log "milter_header_name = " + milter_header_name
#header log "milter_header_value = " + milter_header_value
#header log "milter_header = " + milter_header
eoh log "milter_header_size = " + milter_header_size
eom log "milter_body_size = " + milter_body_size
eom log "milter_queueid = " + milter_queueid

eom log ""
eom log "REJECT"
eom reject
#connect tarpit 1s
#connect tarpit 5s
#envrcpt log "from: " + string_mailaddr(milter_envfrom) + " to: " + string_mailaddr(milter_envrcpt)
#envrcpt greylist 15m
#eom tarpit_delayed add header "X-Tarpit" value tarpit_delayed
#eom greylist_delayed add header "X-Greylist" value greylist_delayed
